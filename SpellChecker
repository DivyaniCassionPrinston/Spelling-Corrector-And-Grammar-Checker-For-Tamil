from fuzzywuzzy import process
from indicnlp.normalize.indic_normalize import IndicNormalizerFactory

# Normalize Tamil text
def normalize_text(text):
    normalizer = IndicNormalizerFactory().get_normalizer("ta")
    return normalizer.normalize(text)

# Load the Tamil dictionary
def load_tamil_words(filepath):
    with open(filepath, 'r', encoding='utf-8') as file:
        words = file.read().splitlines()
    return set(words)

# Detect misspelled words
def detect_misspellings(text, tamil_dict):
    words = text.split()  # Simple word split
    misspelled = [word for word in words if word not in tamil_dict]
    return misspelled

# Suggest corrections
def suggest_corrections(word, tamil_dict):
    suggestions = process.extract(word, tamil_dict, limit=3)
    return [suggestion[0] for suggestion in suggestions]

# Spell checker with corrected text
def tamil_spell_checker(text, wordlist_path):
    tamil_dict = load_tamil_words(wordlist_path)
    normalized_text = normalize_text(text)
    words = normalized_text.split()
    
    # Detect misspellings and get corrections
    misspelled = detect_misspellings(normalized_text, tamil_dict)
    corrections = {}
    corrected_words = []

    for word in words:
        if word in misspelled:
            # Replace misspelled word with the top suggestion
            top_correction = suggest_corrections(word, tamil_dict)[0]
            corrections[word] = suggest_corrections(word, tamil_dict)
            corrected_words.append(top_correction)
        else:
            corrected_words.append(word)
    
    # Join the corrected words into a full corrected text
    corrected_text = ' '.join(corrected_words)
    return corrections, corrected_text

# Input text and wordlist path
text = "உங்களுடைய தொழல் என்ன"
wordlist_path = "tamil_words.txt"

# Run the spell checker
corrections, corrected_text = tamil_spell_checker(text, wordlist_path)

# Output corrections and corrected text
print("Corrections:")
for word, suggestions in corrections.items():
    print(f"{word}: {', '.join(suggestions)}")

print("\nCorrected Text:")
print(corrected_text)

